$((function(){"use strict";let e="../config.php?v="+Date.now();let t=new Date,s="../logs/novedades/"+a(t)+"_novedad.log";function n(e){fetch(e).then((async t=>{if(!t.ok)throw new Error("("+t.status+") "+t.statusText);t=await t.text(),document.getElementById("offcanvasLogsLabel").innerHTML=e+'<span class="refreshLog ms-2 border btn btn-sm" style="cursor:pointer; font-size:0.8rem; color: #ADB6BA">Actualizar</span>',document.getElementById("contentCanva").innerHTML=t,document.getElementById("verLogs").hidden=!1,$(".refreshLog").click((function(){document.getElementById("contentCanva").innerHTML="",setTimeout((function(){n(s+"?v="+Date.now())}),100)}))})).catch((function(t){document.getElementById("offcanvasLogsLabel").innerHTML=e,document.getElementById("contentCanva").innerHTML=t,document.getElementById("verLogs").hidden=!0,$(".refreshLog").click((function(){document.getElementById("contentCanva").innerHTML="",setTimeout((function(){n(s+"?v="+Date.now())}),100)}))}))}function a(e){var t=new Date(e),s=""+(t.getMonth()+1),n=""+t.getDate(),a=t.getFullYear();return s.length<2&&(s="0"+s),n.length<2&&(n="0"+n),[a,s,n].join("")}$("#form").bind("submit",(function(e){e.preventDefault(),$("#submit").prop("disabled",!0),$("#submit").html("Guardar.."),$("#spanRespuesta").html(""),axios({method:"POST",url:"../config/index.php",data:$(this).serialize()}).then((function(e){let t=e.data;"ok"==t.status?($("#submit").prop("disabled",!1),$("#submit").html("Guardar"),$("#spanRespuesta").html("<b>"+t.Mensaje+"</b>"),setTimeout((function(){$("#spanRespuesta").html("")}),6e3)):($("#submit").prop("disabled",!1),$("#submit").html("Guardar"),$("#spanRespuesta").html('<span class="text-danger"><b>'+t.Mensaje+"</b></span>"),setTimeout((function(){$("#spanRespuesta").html("")}),6e3))})).catch((function(e){alert(e),$("#submit").prop("disabled",!1),$("#submit").html("Guardar"),$("#spanRespuesta").html('<span class="text-danger"><b>Error</b></span>'),setTimeout((function(){$("#spanRespuesta").html("")}),6e3),n(s+"?v="+Date.now())}))})),function(e,t){let s=new FormData;s.append("tk",t),axios({method:"POST",url:e,data:s}).then((function(e){let t=e.data;function s(e,t){t?$(e).prop("checked",!0):$(e).prop("checked",!1)}$("#api_url").val(t.api.url),$("#api_pass").val(t.api.pass),$("#api_user").val(t.api.user),$("#mssql_srv").val(t.mssql.srv),$("#mssql_db").val(t.mssql.db),$("#mssql_user").val(t.mssql.user),$("#mssql_pass").val(t.mssql.pass),$("#logs_borrar_dias").val(t.borrarLogs.dias),$("#ws_ip").val(t.webService.url),$("#proxy_puerto").val(t.proxy.port),$("#proxy_ip").val(t.proxy.ip),s("#logs_conn_success",t.logConexion.success),s("#logs_conn_error",t.logConexion.error),s("#logs_nov_error",t.logNovedades.error),s("#logs_nov_success",t.logNovedades.success),s("#logs_borrar_estado",t.borrarLogs.estado),s("#proxy_estado",t.proxy.enabled)})).catch((function(t){alert(e+"\n"+t)}))}(e,a(t)),$("#script").click((function(e){let t=null;e.preventDefault(),$("#script").prop("disabled",!0),$("#script").html("Ejecutando ......"),$("#spanRespuesta").html("Ejecutando script..."),t=setInterval((function(){n(s+"?v="+Date.now())}),1e3),axios({method:"get",url:"../?script=true"}).then((function(e){clearInterval(t);let a=e.data;"ok"==a.status?($("#script").prop("disabled",!1),$("#script").html("Ejecutar Script"),n(s+"?v="+Date.now()),$("#spanRespuesta").html(""),$("#spanRespuesta").html("<b>"+a.Mensaje+"</b>")):($("#script").prop("disabled",!1),$("#script").html("Ejecutar Script"),n(s+"?v="+Date.now()),$("#spanRespuesta").html(""),$("#spanRespuesta").html('<span class="text-danger"><b>'+a.Mensaje+"</b></span>"))})).catch((function(e){clearInterval(t),$("#script").prop("disabled",!1),$("#script").html("Ejecutar Script"),n(s+"?v="+Date.now()),$("#spanRespuesta").html(""),$("#spanRespuesta").html('<span class="text-danger"><b>Error</b></span>'),alert(url+"\n"+e)}))})),n(s+"?v="+Date.now()),document.getElementById("offcanvasLogs").addEventListener("shown.bs.offcanvas",(function(){n(s+"?v="+Date.now())}))}));